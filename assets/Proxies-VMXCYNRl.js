import{u as W,f as e,au as fe,i as r,ai as O,av as be,aw as xe,C as p,ax as pe,ay as $e,az as ye,F,aA as _e,aB as we,aC as Ce,aD as Pe,aE as j,_ as f,aF as Se,aG as Te,aH as Le,aI as Ee,aJ as Z,aK as ve,aL as G,aM as X,O as Ne,t as h,aN as Ie,aO as ne,S as R,aP as N,aQ as he,aR as ee,a0 as A,$ as K,ag as De,G as se,D as ke,V as Me,b as Oe,x as Ae,Q as Fe,y as le,o as Ue,B as Y,aS as ie,a5 as Be,aT as je,aU as ae,aV as ce,aW as oe,aX as de,k as Re}from"./index-BheD7jx9.js";import{f as He}from"./global-Bg60qsmB.js";var Ye=h('<div class="flex flex-col gap-4"><div><div class="flex w-full justify-center"><input class=toggle type=checkbox></div></div><div class="flex flex-col"><input class="input input-bordered w-full"></div><div><input type=number class="input input-bordered w-full"></div><div class="flex flex-col"><input class="input input-bordered w-full"></div><div><select class="select select-bordered w-full"></select></div><div><div class="flex w-full justify-center"><input class=toggle type=checkbox></div></div><div><div class="flex w-full justify-center"><input class=toggle type=checkbox></div></div><div><select class="select select-bordered w-full">'),ze=h('<option class="flex items-center gap-2">'),Qe=h("<option>");const Ve=l=>{const[n]=W();return e(Ne,{ref:t=>{var i;return(i=l.ref)==null?void 0:i.call(l,t)},get icon(){return e(fe,{size:24})},get title(){return n("proxiesSettings")},get children(){var t=Ye(),i=t.firstChild,o=i.firstChild,u=o.firstChild,m=i.nextSibling,L=m.firstChild,d=m.nextSibling,I=d.firstChild,b=d.nextSibling,C=b.firstChild,P=b.nextSibling,S=P.firstChild,g=P.nextSibling,y=g.firstChild,D=y.firstChild,T=g.nextSibling,k=T.firstChild,z=k.firstChild,Q=T.nextSibling,B=Q.firstChild;return r(i,e(O,{withDivider:!0,get children(){return n("autoCloseConns")}}),o),u.addEventListener("change",c=>be(c.target.checked)),r(m,e(O,{withDivider:!0,get children(){return n("urlForLatencyTest")}}),L),L.addEventListener("change",c=>xe(c.target.value)),r(d,e(O,{withDivider:!0,get children(){return[p(()=>n("latencyTestTimeoutDuration"))," (",p(()=>n("ms")),")"]}}),I),I.addEventListener("change",c=>pe(Number(c.target.value))),r(b,e(O,{withDivider:!0,get children(){return n("urlForIPv6SupportTest")}}),C),C.addEventListener("change",c=>{var $;return $e(($=c.target.value)==null?void 0:$.trim())}),r(P,e(O,{withDivider:!0,get children(){return n("proxiesSorting")}}),S),S.addEventListener("change",c=>ye(c.target.value)),r(S,e(F,{get each(){return Object.values(_e)},children:c=>(()=>{var $=ze();return $.value=c,r($,()=>n(c)),$})()})),r(g,e(O,{withDivider:!0,get children(){return n("hideUnAvailableProxies")}}),y),D.addEventListener("change",c=>we(c.target.checked)),r(T,e(O,{withDivider:!0,get children(){return n("renderInTwoColumns")}}),k),z.addEventListener("change",c=>Ce(c.target.checked)),r(Q,e(O,{withDivider:!0,get children(){return n("proxiesPreviewType")}}),B),B.addEventListener("change",c=>Pe(c.target.value)),r(B,e(F,{get each(){return Object.values(j)},children:c=>(()=>{var $=Qe();return $.value=c,r($,()=>n(c)),$})()})),f(()=>u.checked=Se()),f(()=>L.value=Te()),f(()=>I.value=Le()),f(()=>C.value=Ee()),f(()=>S.value=Z()),f(()=>D.checked=ve()),f(()=>z.checked=G()),f(()=>B.value=X()),t}})},ue=l=>{const n=()=>X()===j.OFF,t=p(()=>l.proxyNameList.length<=10),i=p(()=>{const u=X();return u===j.BAR||u===j.Auto&&!t()}),o=p(()=>{const u=X();return u===j.DOTS||u===j.Auto&&t()});return e(R,{get when(){return!n()},get children(){return e(Ie,{get children(){return[e(ne,{get when(){return i()},get children(){return e(Ke,{get proxyNameList(){return l.proxyNameList},get now(){return l.now}})}}),e(ne,{get when(){return o()},get children(){return e(Ze,{get proxyNameList(){return l.proxyNameList},get now(){return l.now}})}})]}})}})};var Xe=h('<div class="flex items-center gap-2 py-2"><div class="my-2 flex flex-1 items-center justify-center overflow-hidden rounded-2xl [&amp;>*]:h-2"><div class=bg-success></div><div class=bg-warning></div><div class=bg-error></div><div class=bg-neutral>');const Ke=l=>{const{getLatencyByName:n}=ee(),t=p(()=>l.proxyNameList.map(d=>n(d))),i=p(()=>t().length),o=p(()=>t().filter(d=>d>N().NOT_CONNECTED&&d<=N().MEDIUM).length),u=p(()=>t().filter(d=>d>N().MEDIUM&&d<=N().HIGH).length),m=p(()=>t().filter(d=>d>N().HIGH).length),L=p(()=>t().filter(d=>d===N().NOT_CONNECTED).length);return(()=>{var d=Xe(),I=d.firstChild,b=I.firstChild,C=b.nextSibling,P=C.nextSibling,S=P.nextSibling;return r(d,e(he,{get name(){return l.now}}),null),f(g=>{var y=`${o()*100/i()}%`,D=`${u()*100/i()}%`,T=`${m()*100/i()}%`,k=`${L()*100/i()}%`;return y!==g.e&&((g.e=y)!=null?b.style.setProperty("width",y):b.style.removeProperty("width")),D!==g.t&&((g.t=D)!=null?C.style.setProperty("width",D):C.style.removeProperty("width")),T!==g.a&&((g.a=T)!=null?P.style.setProperty("width",T):P.style.removeProperty("width")),k!==g.o&&((g.o=k)!=null?S.style.setProperty("width",k):S.style.removeProperty("width")),g},{e:void 0,t:void 0,a:void 0,o:void 0}),d})()};var We=h("<div>"),Je=h('<div class="flex items-center gap-2 py-2"><div class="flex flex-1 flex-wrap items-center gap-1">');const qe=l=>{let n=l.selected?"bg-white border-4 border-success":"bg-success";return typeof l.latency!="number"||l.latency===N().NOT_CONNECTED?n=l.selected?"bg-white border-4 border-neutral":"bg-neutral":l.latency>N().HIGH?n=l.selected?"bg-white border-4 border-error":"bg-error":l.latency>N().MEDIUM&&(n=l.selected?"bg-white border-4 border-warning":"bg-warning"),(()=>{var t=We();return f(i=>{var o=A("h-4 w-4 rounded-full",n),u=l.name;return o!==i.e&&K(t,i.e=o),u!==i.t&&De(t,"title",i.t=u),i},{e:void 0,t:void 0}),t})()},Ze=l=>{const{getLatencyByName:n}=ee();return(()=>{var t=Je(),i=t.firstChild;return r(i,e(F,{get each(){return l.proxyNameList.map(o=>[o,n(o)])},children:([o,u])=>{const m=l.now===o;return e(qe,{name:o,latency:u,selected:m})}})),r(t,e(he,{get name(){return l.now}}),null),t})()};var Ge=h("<progress class=progress max=100>"),et=h('<div class="text-sm text-slate-500"> / <!> ( <!>% )'),tt=h('<div class="text-sm text-slate-500">: ');const rt=l=>{const{Download:n=0,Upload:t=0,Total:i=0,Expire:o=0}=l,u=se(i,{units:"iec"}),m=se(n+t,{units:"iec"}),L=ke.toFinite(((n+t)/i*100).toFixed(2));return{total:u,used:m,percentage:L,expirePrefix:()=>{const[b]=W();return b("expire")},expireStr:()=>{const[b]=W();return o===0?b("noExpire"):Me(o*1e3).format("YYYY-MM-DD")}}},nt=l=>{if(!l.subscriptionInfo)return;const n=rt(l.subscriptionInfo);return[(()=>{var t=Ge();return f(()=>t.value=n.percentage),t})(),(()=>{var t=et(),i=t.firstChild,o=i.nextSibling,u=o.nextSibling,m=u.nextSibling;return m.nextSibling,r(t,()=>`${n.used}`,i),r(t,()=>`${n.total}`,o),r(t,()=>n.percentage,m),t})(),(()=>{var t=tt(),i=t.firstChild;return r(t,()=>n.expirePrefix(),i),r(t,()=>n.expireStr(),null),t})()]};var ge=h("<div>"),st=h('<div class="flex h-full flex-col gap-2"><div class="flex items-center gap-2"><div class="tabs-boxed tabs gap-2 pl-0"></div><div class=ml-auto></div></div><div class="flex-1 overflow-y-auto">'),lt=h('<button><span></span><div class="badge badge-sm">'),it=h('<div class="flex items-center justify-between pr-8"><div class="flex items-center gap-2"><span></span><div class="badge badge-sm">'),at=h('<div class="text-sm text-slate-500"> '),ct=h('<div class="flex items-center justify-between pr-8"><div class="flex items-center gap-2"><span></span><div class="badge badge-sm"></div></div><div class="flex items-center gap-2">'),ot=h('<div class="text-sm text-slate-500"> :: <!> ');const gt=()=>{const l=Oe();if(!Ae())return l("/setup",{replace:!0}),null;let n;const[t]=W(),{fetchProxies:i,proxies:o,selectProxyInGroup:u,proxyProviders:m,updateProviderByProviderName:L,updateAllProvider:d,proxyGroupLatencyTest:I,proxyProviderLatencyTest:b,proxyGroupLatencyTestingMap:C,proxyProviderLatencyTestingMap:P,isAllProviderUpdating:S,updatingMap:g}=ee(),[y,D]=Fe(le({}),{name:"collapsedMap",storage:localStorage}),T=(x,_)=>{D(V=>({...V,[x]:_}))};Ue(i);const k=async(x,_)=>{x.stopPropagation(),I(_)},z=(x,_)=>{x.stopPropagation(),b(_)},Q=(x,_)=>{x.stopPropagation(),L(_)},B=async x=>{x.stopPropagation(),d()},[c,$]=le("proxies"),me=()=>[{type:"proxies",name:t("proxies"),count:o().length},{type:"proxyProviders",name:t("proxyProviders"),count:m().length}];return(()=>{var x=st(),_=x.firstChild,V=_.firstChild,te=V.nextSibling,re=_.nextSibling;return r(V,e(F,{get each(){return me()},children:v=>(()=>{var s=lt(),M=s.firstChild,H=M.nextSibling;return s.$$click=()=>$(v.type),r(M,()=>v.name),r(H,()=>v.count),f(()=>K(s,A(c()===v.type&&"tab-active","tab-sm sm:tab-md tab gap-2 px-2"))),s})()})),r(_,e(R,{get when(){return c()==="proxyProviders"},get children(){return e(Y,{class:"btn btn-circle btn-sm",get disabled(){return S()},onClick:v=>B(v),get icon(){return e(ie,{get class(){return A(S()&&"animate-spin text-success")}})}})}}),te),r(te,e(Y,{class:"btn-circle btn-primary btn-sm",onClick:()=>n==null?void 0:n.showModal(),get icon(){return e(Be,{})}})),r(re,e(R,{get when(){return c()==="proxies"},get children(){var v=ge();return r(v,e(F,{get each(){return o()},children:s=>{const M=p(()=>je(ae(s.all??[],Z()),ve())),H=[(()=>{var a=it(),E=a.firstChild,w=E.firstChild,J=w.nextSibling;return r(w,()=>s.name),r(J,()=>{var U;return(U=s.all)==null?void 0:U.length}),r(a,e(Y,{class:"btn-circle btn-sm",get disabled(){return C()[s.name]},onClick:U=>k(U,s.name),get icon(){return e(ce,{get class(){return A(C()[s.name]&&"animate-pulse text-success")}})}}),null),a})(),(()=>{var a=at(),E=a.firstChild;return r(a,()=>{switch(s.type){case"Selector":return t("selector");case"Direct":return t("direct");case"Urltest":return t("urltest");case"Reject":return t("reject");case"Loadbalance":return t("loadbalance");case"Fallback":return t("fallback");case"Relay":return t("relay");default:return s.type}},E),r(a,()=>{var w;return((w=s.now)==null?void 0:w.length)>0&&` > ${s.now}`},null),a})(),e(R,{get when(){return!y()[s.name]},get children(){return e(ue,{get proxyNameList(){return M()},get now(){return s.now}})}})];return e(oe,{get isOpen(){return y()[s.name]},title:H,onCollapse:a=>T(s.name,a),get children(){return e(F,{get each(){return M()},children:a=>e(de,{proxyName:a,get isSelected(){return s.now===a},onClick:()=>void u(s,a)})})}})}})),f(()=>K(v,A("grid grid-cols-1 place-items-start gap-2",G()?"sm:grid-cols-2":"sm:grid-cols-1"))),v}}),null),r(re,e(R,{get when(){return c()==="proxyProviders"},get children(){var v=ge();return r(v,e(F,{get each(){return m()},children:s=>{const M=p(()=>ae(s.proxies.map(a=>a.name)??[],Z())),H=[(()=>{var a=ct(),E=a.firstChild,w=E.firstChild,J=w.nextSibling,U=E.nextSibling;return r(w,()=>s.name),r(J,()=>s.proxies.length),r(U,e(Y,{class:"btn btn-circle btn-sm",get disabled(){return g()[s.name]},onClick:q=>Q(q,s.name),get icon(){return e(ie,{get class(){return A(g()[s.name]&&"animate-spin text-success")}})}}),null),r(U,e(Y,{class:"btn btn-circle btn-sm",get disabled(){return P()[s.name]},onClick:q=>z(q,s.name),get icon(){return e(ce,{get class(){return A(P()[s.name]&&"animate-pulse text-success")}})}}),null),a})(),e(nt,{get subscriptionInfo(){return s.subscriptionInfo}}),(()=>{var a=ot(),E=a.firstChild,w=E.nextSibling;return w.nextSibling,r(a,()=>s.vehicleType,E),r(a,()=>t("updated"),w),r(a,()=>He(s.updatedAt),null),a})(),e(R,{get when(){return!y()[s.name]},get children(){return e(ue,{get proxyNameList(){return M()}})}})];return e(oe,{get isOpen(){return y()[s.name]},title:H,onCollapse:a=>T(s.name,a),get children(){return e(F,{get each(){return M()},children:a=>e(de,{proxyName:a})})}})}})),f(()=>K(v,A("grid grid-cols-1 place-items-start gap-2",G()?"sm:grid-cols-2":"sm:grid-cols-1"))),v}}),null),r(x,e(Ve,{ref:v=>n=v}),null),x})()};Re(["click"]);export{gt as default};
